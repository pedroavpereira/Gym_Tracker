<!doctype html>
<html>
    <head>
        <title>Workout Planner</title>
        <meta charset="utf-8">

        <link rel="stylesheet" href="style/style.css">

        
    </head>
    <body>
        <h1>Workout Sheet</h1>
        <div class="btnContainer">
            <input type="text" id="addInput">
            <button id="btnAdd">Add</button>
            <button id="btnRemove">Clear</button>
            <button id="btnSave">Save</button>
        </div>


        <ul id="accordion">
        </ul>






        <script>
            'use strict'
            var $inputAdd = document.getElementById("addInput");
            var $btnAdd = document.getElementById("btnAdd");
            var $btnRemove = document.getElementById("btnRemove");
            var $btnSave = document.getElementById("btnSave");

            var exerciseNameArr = new Array;
            var exerciseVolumeArr = new Array;
            var inputNum = 1;
            var numEx = 0;


            $btnAdd.addEventListener("click", exerciseAdd);
            $btnRemove.addEventListener("click", deleteExercises);
            $btnSave.addEventListener("click", saveVolumeValues);



            verifyLocalStorage();
            createStoragedInitial(exerciseNameArr,exerciseVolumeArr);



           



          
            function createStoragedInitial(exArr,volumeArr){
                createStoragedExercises(exArr);
                initialUpdateVolume(volumeArr);
                
            }

            function createStoragedExercises(arr){
                for (var i=0; i < arr.length; i++){
                    mainConstructor(arr[i]);
                }
            }

            function initialUpdateVolume(arr){
                var $inputValues = document.querySelectorAll(".inputValue");
                for(var i = 0; i < arr.length; i++){
                    $inputValues[i].value = arr[i];
                }
            }







            function verifyLocalStorage(){
                if(localStorage.getItem("exerciseNames")){
                    var localStorageExStr = localStorage.getItem("exerciseNames")
                    exerciseNameArr = localStorageExStr.split(",");
                }
                if(localStorage.getItem("exerciseVolume")){
                var localStorageVolumeStr = localStorage.getItem("exerciseVolume");
                    exerciseVolumeArr = localStorageVolumeStr.split(",");
                }
            }

            function updateLocalStorage(newExerciseName){
                if(newExerciseName !== undefined){
                exerciseNameArr.push(newExerciseName);
                }

                localStorage.setItem("exerciseNames", exerciseNameArr);
                localStorage.setItem("exerciseVolume", exerciseVolumeArr);
            }

            function saveVolumeValues(){
                var $inputValue = document.querySelectorAll(".inputValue")
                for(var i = 0; i < $inputValue.length; i++){
                    exerciseVolumeArr[i] = $inputValue[i].value;
                }
                updateLocalStorage();
            }




            function exerciseAdd(){
            var typedName = $inputAdd.value
                if(typedName){
                    mainConstructor(typedName);
                    updateLocalStorage(typedName);
                    $inputAdd.value = "";
                }
            }

            function deleteExercises(){
                var $exerciseUl = document.getElementById("accordion");
                $exerciseUl.innerHTML = "";
                $inputAdd.value= "";
                localStorage.clear();
                exerciseNameArr = [];
                numEx = 0;
            }






            function mainConstructor(exerciseName){
                var $exerciseUl = document.getElementById("accordion");

            //Create a new Li tag
                var newLi = liConstructor();

            //Create a label and a radio input and add to the new li
                newLi = radioConstructor(newLi, exerciseName);

            //Create a new contentDiv and add to the new li
                newLi = contentConstructor(newLi);
                
            //Append the newly created li to the document    
                $exerciseUl.appendChild(newLi);
            }


            function liConstructor(){
                var newLi = document.createElement("li");
                return newLi;
            }


            function radioConstructor(newLi, exerciseName){

                var newId = "radio" + numEx;
            //Create a new Label with the name and the "for" attribute with a new number    
                var newLabel = document.createElement("label");
                newLabel.innerHTML = exerciseName + "<span>&#x3e;</span";
                
                newLabel.setAttribute("for", newId);
                
            //Add the new label to the new Li
                newLi.appendChild(newLabel);
                
            //Create a new Radio input with the name "accordion" and the same id as the label previously created
                var newRadio = document.createElement("input");
                newRadio.setAttribute("type","radio");
                newRadio.setAttribute("name","accordion");
                newRadio.setAttribute("id", newId);
                newRadio.checked = true;

            //Add new Radio input to the List (now should contain a label and a radio input)
                newLi.appendChild(newRadio);
 

                numEx++;

                return newLi;
            }



            function contentConstructor(newLi){
                var contentDiv = document.createElement("div");
                contentDiv.classList.add("content");

                for(var i = 0; i<3;i++){

                    var newId = "valueId" + inputNum;
                    inputNum++;
                
                    var newInput = document.createElement("input");
                    newInput.setAttribute("type","number");
                    newInput.setAttribute("class", "inputValue");
                    newInput.setAttribute("id", newId);
                    

                    var newLabel = document.createElement("label");

                    switch(i){
                        case 0: 
                            newLabel.textContent = "Sets";
                            break;
                        case 1:
                            newLabel.textContent = "Reps";
                            break;
                        case 2:
                            newLabel.textContent = "Weight";
                            break;
                    }

                    contentDiv.appendChild(newLabel);
                    contentDiv.appendChild(newInput);

                }
                
                newLi.appendChild(contentDiv);

                return newLi;
            }



        </script>
         
        
    </body>
</html>
